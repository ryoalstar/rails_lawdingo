<div id="page" class="framey-video">
  <div>
    <%= render partial: "lawyer/menu", locals: { lawyer: current_user } %>

    <h2>Introduce yourself to prospective clients in a video of up to two minutes long.</h2>

    <% unless @lawyer.has_video? %>
      <div class="recorder-wrapper">
        <input id="FrameyRecorder" type="video" data-params="{ api_key: '<%= Framey::API_KEY %>' }" />
      </div>
    <% else %>
      <div class="player-wrapper">
        <%= render_player({
          video_url: @video.flv_url,
          thumbnail_url: @video.large_thumbnail_url,
        }) %>

        <div class="controls">
          <%= link_to "Re-record", @video, method: :delete, confirm: "Are you sure?", class: "button gray" %>
          <span class="notice">Current video will be deleted.</span>
        </div>
      </div>
    <% end %>
  </div>
</div>

<%= javascript_tag do %>
  // Id of framey input[type="video"]
  var recorderId = "FrameyRecorder";

  // Set user id as a creator_id
  Framey.observe(recorderId, "recordClicked", function(data) {
    Framey.getRecorder(recorderId).setAllSessionData({"creator_id": <%= current_user.id.to_s if current_user.present? %>});
  });
<% end %>
